# Çok Dilli Masaüstü Uygulama İçin Veritabanı Tasarımı

Bu doküman, masaüstü uygulamanızda tüm metinlerin veritabanından
gelmesini ve çoklu dil desteğini sağlamayı amaçlayan bir **i18n
(internationalization)** yapısını anlatmaktadır.

## 1. Dil Tablosu

``` sql
CREATE TABLE LANG (
  LANG_CODE        VARCHAR2(10)  PRIMARY KEY, -- 'tr-TR', 'en-US', 'ar'
  LANG_NAME        VARCHAR2(100) NOT NULL,    -- Türkçe (Türkiye)
  FALLBACK_LANG    VARCHAR2(10)  NULL,        -- ör: 'en'
  IS_RTL           NUMBER(1)     DEFAULT 0,   -- sağdan sola diller için 1
  CREATED_AT       TIMESTAMP     DEFAULT SYSTIMESTAMP,
  UPDATED_AT       TIMESTAMP     NULL,
  CREATED_BY       VARCHAR2(50),
  UPDATED_BY       VARCHAR2(50),
  CONSTRAINT FK_LANG_FALLBACK FOREIGN KEY (FALLBACK_LANG) REFERENCES LANG(LANG_CODE)
);
```

## 2. Kaynak Anahtar Tablosu

``` sql
CREATE TABLE I18N_RESOURCE (
  RESOURCE_ID      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  SCOPE            VARCHAR2(100) NULL,        -- ör: 'Auth/Login'
  RES_KEY          VARCHAR2(150) NOT NULL,    -- ör: 'button.login'
  DESCRIPTION      VARCHAR2(500) NULL,        -- çevirmen açıklaması
  DEFAULT_TEXT     CLOB NULL,                 -- varsayılan dil metni (örn en)
  IS_ACTIVE        NUMBER(1) DEFAULT 1,
  CREATED_AT       TIMESTAMP DEFAULT SYSTIMESTAMP,
  UPDATED_AT       TIMESTAMP NULL,
  CREATED_BY       VARCHAR2(50),
  UPDATED_BY       VARCHAR2(50),
  CONSTRAINT UQ_I18N_RESOURCE UNIQUE (SCOPE, RES_KEY)
);
CREATE INDEX IX_I18N_RESOURCE_SCOPE ON I18N_RESOURCE (SCOPE);
```

## 3. Çeviri Tablosu

``` sql
CREATE TABLE I18N_TRANSLATION (
  RESOURCE_ID      NUMBER       NOT NULL,
  LANG_CODE        VARCHAR2(10) NOT NULL,
  TEXT_VALUE       CLOB         NOT NULL,
  STATUS           VARCHAR2(20) DEFAULT 'APPROVED',
  UPDATED_AT       TIMESTAMP    DEFAULT SYSTIMESTAMP,
  UPDATED_BY       VARCHAR2(50),
  PRIMARY KEY (RESOURCE_ID, LANG_CODE),
  CONSTRAINT FK_TR_RES  FOREIGN KEY (RESOURCE_ID) REFERENCES I18N_RESOURCE(RESOURCE_ID),
  CONSTRAINT FK_TR_LANG FOREIGN KEY (LANG_CODE)   REFERENCES LANG(LANG_CODE)
);
CREATE INDEX IX_TR_LANG ON I18N_TRANSLATION (LANG_CODE);
```

## ICU Format Kullanımı

ICU format, değişken yerleştirme, çoğul ve cinsiyet gibi durumları
yönetir.

Örnek: - `en`:
`{count, plural, =0 {Your cart is empty} one {# item in cart} other {# items in cart}}` -
`tr`:
`{count, plural, =0 {Sepetin boş} one {Sepetinde # ürün var} other {Sepetinde # ürün var}}`

## Fallback Mekanizması

``` sql
WITH REQ AS (
  SELECT :lang AS LANG_CODE FROM DUAL
), L AS (
  SELECT LANG_CODE, FALLBACK_LANG FROM LANG WHERE LANG_CODE = (SELECT LANG_CODE FROM REQ)
), T_REQ AS (
  SELECT r.RESOURCE_ID, r.DEFAULT_TEXT,
         (SELECT TEXT_VALUE FROM I18N_TRANSLATION t
           WHERE t.RESOURCE_ID = r.RESOURCE_ID AND t.LANG_CODE = (SELECT LANG_CODE FROM REQ)
         ) AS TEXT_LANG,
         (SELECT TEXT_VALUE FROM I18N_TRANSLATION t
           WHERE t.RESOURCE_ID = r.RESOURCE_ID AND t.LANG_CODE = (SELECT FALLBACK_LANG FROM L)
         ) AS TEXT_FB
  FROM I18N_RESOURCE r
  WHERE r.SCOPE = :scope AND r.RES_KEY = :key AND r.IS_ACTIVE = 1
)
SELECT COALESCE(TEXT_LANG, TEXT_FB, DEFAULT_TEXT) AS TEXT_VALUE
FROM T_REQ;
```

## İyi Pratikler

-   Anahtar stratejisi: `scope.key`
-   Açıklama alanı ile çevirmenlere bağlam sağlamak
-   ICU standardı ile çoğul ve değişken desteği
-   RTL (sağdan sola) desteği
-   Performans için uygulama başında cache yükleme
-   Eksik çeviri raporları
